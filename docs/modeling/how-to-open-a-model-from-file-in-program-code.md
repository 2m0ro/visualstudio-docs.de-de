---
title: "Gewusst wie: &#214;ffnen eines Modells aus einer Datei im Programmcode | Microsoft Docs"
ms.custom: ""
ms.date: "12/15/2016"
ms.prod: "visual-studio-tfs-dev14"
ms.reviewer: ""
ms.suite: ""
ms.tgt_pltfrm: ""
ms.topic: "article"
ms.assetid: d7d68697-5418-4263-bdb2-48401924ea71
caps.latest.revision: 8
caps.handback.revision: 8
author: "alancameronwills"
ms.author: "awills"
manager: "douge"
---
# Gewusst wie: &#214;ffnen eines Modells aus einer Datei im Programmcode
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

Sie können DSL\-Modelle in jeder Anwendung öffnen.  
  
 Von einer [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] Erweiterung können Sie ModelBus zu diesem Zweck verwenden.  ModelBus stellt Mechanismus zur Standardeinstellung für Verweise eines Modells oder der Elemente in einem Modell sowie zum Durchsuchen des Modells bereit, wenn es verschoben wurde.  Weitere Informationen finden Sie unter [Integrieren von Modellen mit Visual Studio\-Modelbus](../modeling/integrating-models-by-using-visual-studio-modelbus.md).  
  
## Zielframework  
 Legen Sie **Zielframework** des Anwendungsprojekts auf **.NET Framework 4**fest.  
  
#### So legen Sie das Zielframework  
  
1.  Öffnen Sie das [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] Projekt für die Anwendung, in der Sie ein DSL\-Modell lesen möchten.  
  
2.  Klicken Sie im **Projektmappen\-Explorer** mit der rechten Maustaste auf das Projekt, und klicken Sie dann auf **Eigenschaften**.  
  
3.  Klicken Sie im Fenster Projekteigenschaften auf der Registerkarte **Anwendung** Satz das Feld zu **Zielframework.NET Framework 4**.  
  
> [!NOTE]
>  Möglicherweise müssen Sie dies tun, auch wenn Sie im Dialogfeld Projekt **.NET Framework 4** Builds ausgewählt haben.  Das Zielframework sollte nicht **.NET Framework 4 Client Profile**sein.  
  
## Verweise  
 Sie müssen diese Verweise auf das [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] Anwendungsprojekt hinzufügen:  
  
-   `Microsoft.VisualStudio.Modeling.Sdk.11.0`  
  
    -   Wenn Sie dies nicht mit der **.NET** Registerkarte im Dialogfeld **Verweise hinzufügen** anzuzeigen, klicken Sie auf die Registerkarte **Durchsuchen** und navigieren Sie zu `Verzeichnis %Programme% \ Microsoft Visual Studio 2010 \ SDK \ Assemblies \ Common \ VisualStudioIntegration`.  
  
-   Die DSL\-Assembly, die unter dem Ordner bin das DSL\-Projekt suchen.  Dieser Name ist normalerweise folgende Form: *Das Unternehmen*.*TheProject*`. Dsl.dll`.  
  
## Wichtige Klassen im DSL  
 Bevor Sie den Code schreiben können, der das DSL liest, sollten Sie die Namen einiger Klassen kennen, die vom DSL generiert werden.  In der DSL\-Projektmappe öffnen Sie das Projekt und **Dsl** finden Sie im **GeneratedCode** Ordner.  Alternativ doppelklicken Sie auf die DSL\-Assembly **Verweise**im Projekt, und öffnen Sie den DSL\-Namespace in **Objektkatalog**.  
  
 Dies sind die Klassen, die Sie feststellen können:  
  
-   *TheDslRootClass* \- Dies ist der Name der Stammklasse in `DslDefinition.dsl`.  
  
-   *TheDslName* `SerializationHelper` :Diese Klasse wird in `SerializationHelper.cs` im DSL\-Projekt definiert.  
  
-   *TheDslName* `DomainModel` :Diese Klasse wird in `DomainModel.cs` im DSL\-Projekt definiert.  
  
## Lesen aus einer Datei  
 Im folgenden Beispiel wurde entworfen, um ein DSL zu lesen, in dem die wichtigen Klassen lauten wie folgt:  
  
-   FamilyTreeModel  
  
-   FamilyTreeSerializationHelper  
  
-   FamilyTreeDomainModel  
  
 Die andere Domänenklasse in diesem DSL ist Person.  
  
```  
using System;  
using Microsoft.VisualStudio.Modeling;  
using Company.FamilyTree; // Your DSL namespace  
  
namespace StandaloneReadDslConsole  
{ class Program  
  { static void Main(string[] args)  
    {  
      // The path of a DSL model file:  
      string dslModel = @"C:\FamilyTrees\Tudor.ftree";  
      // Set up the Store to read your type of model:  
      Store store = new Store(  
        typeof(Company.FamilyTree.FamilyTreeDomainModel));  
      // The Model type generated by the DSL:  
      FamilyTreeModel familyTree;  
      // All Store changes must be in a Transaction:  
      using (Transaction t =   
        store.TransactionManager.BeginTransaction("Load model"))  
      {  
        familyTree =   
           FamilyTreeSerializationHelper.Instance.  
              LoadModel(store, dslModel, null, null, null);  
        t.Commit(); // Don't forget this!  
      }  
      // Now we can read the model:  
      foreach (Person p in familyTree.People)  
      {  
        Console.WriteLine(p.Name);   
        foreach (Person child in p.Children)  
        {  
          Console.WriteLine("    " + child.Name);  
        }  
} } } }  
```  
  
## Speichern einer Datei  
 Die folgende Zusatz zum vorherigen Code nimmt eine Änderung am Modell und speichert sie in einer Datei.  
  
```  
using (Transaction t =  
  store.TransactionManager.BeginTransaction("update model"))  
{  
  // Create a new model element:  
  Person p = new Person(store);  
  // Set its embedding relationship:  
  p.FamilyTreeModel = familyTree;  
  // - same as: familyTree.People.Add(p);  
  // Set its properties:  
  p.Name = "Edward VI";  
  t.Commit(); // Don't forget this!  
}  
// Save the model:  
try  
{  
  SerializationResult result = new SerializationResult();  
  FamilyTreeSerializationHelper.Instance  
    .SaveModel(result, familyTree, @"C:\FamilyTrees\Tudor-upd.ftree");  
  // Report any error:  
  if (result.Failed)  
  {  
    foreach (SerializationMessage message in result)  
    {  
      Console.WriteLine(message);  
    }  
  }  
}  
catch (System.IO.IOException ex)  
{ ... }  
```